{% extends "main.html" %}

{% block content %}

<nav id="leftmenu">
    <a href="/preferences"><img src="/images/Preferences_100.png" width="100" height="100" alt="" /></a>
</nav>

<section id="content">
    <h1>{{ str.preferences }}</h1>
    {{ str.preferences_page_info }}

    <div class="vertical_table">
        <div class="table_row">
            <div class="header_cell">
                {{ str.user }}:
            </div>
            <div class="table_cell">
                {{ user.email }}
            </div>
        </div>
        <div class="table_row">
            <div class="header_cell">
                {{ str.created }}:
            </div>
            <div class="table_cell">
                {{ user.created|date:"d.m.Y" }}
            </div>
        </div>
        <div class="table_row">
            <div class="header_cell">
                {{ str.libraries }}:
            </div>
            <div class="table_cell">
                {% for person in user.persons %}
                    {{ person.library.name }} ({{ person.forename }} {{ person.surname }})<br />
                {% endfor %}
                <a href="">{{ str.create_personal_library }}...</a>
            </div>
        </div>
        <div class="table_row">
            <div class="header_cell">
                {{ str.language }}:
            </div>
            <div class="table_cell">
                <select id="language" name="language">
                    <option value="estonian"{% ifequal user.language "estonian" %} selected{% endifequal %}>{{ str.lang_estonian }}</option>
                    <option value="english"{% ifequal user.language "english" %} selected{% endifequal %}>{{ str.lang_english }}</option>
                    <option value="russian"{% ifequal user.language "russian" %} selected{% endifequal %}>{{ str.lang_russian }}</option>
                </select><br />
            </div>
        </div>
    </div>

</section>

<script>
    $(document).ready(function(){
        $('#language').change(function() {
            $.post('/preferences', { language: $(this).val() }, function(data) {
                window.location = '';
            });
        });
    });
</script>

{% endblock %}